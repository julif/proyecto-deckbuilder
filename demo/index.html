<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> demo - proyecto deckbuilder </title>
    <!-- javascript -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src='plugins/draganddrop.js' type='text/javascript'></script>
    <!-- css -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!--  seleccion de personajes -----------------------------------------------------------  -->
  <section id="seleccion_de_personajes"> 
    <h2>Seleccionar personaje:</h2> 
    <div id="char_1" class="selectable_character" > seleccionar personaje 1 </div>
    <div id="char_2" class="selectable_character" > seleccionar personaje 2 </div>
    <div id="char_3" class="selectable_character" > seleccionar personaje 3 </div>
  </section>
<!--  personaje -------------------------------------------------------------------------- -->
  <section id="personaje_seleccionado" style="display: none;">
    <h2> mazo inicial:</h2>
    <h3 id="char"></h3>
    <p id="mazo_inicial_div"></p>
    <button onclick="back_personajes()" > volver a seleccion de personajes</button>
    <button onclick="play()" > Jugar </button>
  </section>
<!--  battle stage ----------------------------------------------------------------------- -->
  <section id="battle_stage" style="display: none;">
    <h2>battle stage</h2>
    <div id="enemys"></div>
    <h3> mazo: </h3>
    <p id="mazo_jugador_div" style=" display: flex;"></p>
    <h3>Pila de descarte:</h3>
    <div id="pila_de_descarte"></div>
    
  </section>
</body>
<script>

    //seleccionar un personaje --------------------------------------------------------------------------------------
    var personajeID;
    
    const divs = document.querySelectorAll('.selectable_character');
    divs.forEach(el => el.addEventListener('click', event => {
        personajeID = el.id;
        select_personaje();
    }));
    function select_personaje() {

document.getElementById("seleccion_de_personajes").style.display="none";
document.getElementById("personaje_seleccionado").style.display="inherit";

var char_div=  document.getElementById("char");
    switch (personajeID) { 
      case "char_1":
        char_div.innerHTML= "Personaje 1: Bunny";
        var mazo_inicial = [
          { name: 'carta 1', id: 1 },
          { name: 'carta 2', id: 2 },
          { name: 'carta 3', id: 3 },
          { name: 'carta 4', id: 4 },
          { name: 'carta 5', id: 5 },
          { name: 'carta 6', id: 6 },
          { name: 'carta 7', id: 7 },
          { name: 'carta 8', id: 8 },
          { name: 'carta 9', id: 9 },
          { name: 'carta 10', id: 10 }
        ];
      break
      case "char_2":
        char_div.innerHTML= "Personaje 2: Nero";
        var mazo_inicial = [
          { name: 'carta 11', id: 11 },
          { name: 'carta 12', id: 12 },
          { name: 'carta 13', id: 13 },
          { name: 'carta 14', id: 14 },
          { name: 'carta 15', id: 15 },
          { name: 'carta 16', id: 16 },
          { name: 'carta 17', id: 17 },
          { name: 'carta 18', id: 18 },
          { name: 'carta 19', id: 19 },
          { name: 'carta 20', id: 20 }
        ];
      break
      case "char_3":
        char_div.innerHTML= "Personaje 3: Shacta";
        var mazo_inicial = [
          { name: 'carta 21', id: 21 },
          { name: 'carta 22', id: 22 },
          { name: 'carta 23', id: 23 },
          { name: 'carta 24', id: 24 },
          { name: 'carta 25', id: 25 },
          { name: 'carta 26', id: 26 },
          { name: 'carta 27', id: 27 },
          { name: 'carta 28', id: 28 },
          { name: 'carta 29', id: 29 },
          { name: 'carta 30', id: 30 }
        ];
      break
      default:
        char_div.innerHTML= " Error ";
      }
     // ordenar el array ------------------
     mazo_inicial=  mazo_inicial.sort(function(a, b) {
        return (a.name > b.name) ? 1 : ((b.name > a.name) ? -1 : 0); /* ordenar por nombre */
    })

      mazo_inicial.forEach(myFunction);
    function myFunction(item, index) {
        document.getElementById("mazo_inicial_div").innerHTML += "id: "+ item.id +" name: "+ item.name +" </br>"; 
    }

     //mezclar mazo y mostrarlo en el div "mazo"
     var mazo_jugador = mazo_inicial.slice();//clona el mazo_jugador pero de manera independiente.
       mazo_jugador.sort(function() {return Math.random() - 0.5});

      // mostrar mazo de el jugador ------------------
      mazo_jugador.forEach( function(item, index) {
        document.getElementById("mazo_jugador_div").innerHTML += "<carta id='"+ item.id +"' class='dragdrop' > "+ item.name +" </carta>";
      });




    $(function() {
      $('.dragdrop').draggable({
         revert: true,
         placeholder: true,
         droptarget: '.drop',
         drop: function(evt, droptarget) {
             var currentID = evt.target.id;/*- returns  the id. */
             //var currentVALUE = evt.target.attributes.name.value;

             $(this).appendTo(droptarget).draggable('destroy');
            // console.log(currentID);//ejecuta el codigo
            //console.log(evt.target.innerHTML);//ejecuta el codigo

            $("#pila_de_descarte").append( evt.target.innerHTML + "</br>");
             $('.drop').find('.dragdrop').remove(); // borra los elementos una vez dentro de el drop
             atacar();
         }
      });
    });

 }
 
   
 function back_personajes() {
  personajeID= null;
  //mazo_inicial= null;
  document.getElementById("mazo_inicial_div").innerHTML=" ";
  document.getElementById("mazo_jugador_div").innerHTML=" ";
  document.getElementById("personaje_seleccionado").style.display="none";
  document.getElementById("seleccion_de_personajes").style.display="inherit";
}
function play(){
    document.getElementById("personaje_seleccionado").style.display="none";
    document.getElementById("battle_stage").style.display="inherit";
  }
  function atacar() {
  //alert( " 10 de da√±o al slime ");
 }
 show_enemy();
 function show_enemy() {
  var aleatorio = Math.round(Math.random()*10);
  console.log(aleatorio);
  if( aleatorio < 6 ){
    document.getElementById("enemys").innerHTML="<enemy class='drop' id='enemy1' style='display: inline-block;'> <img src='https://opengameart.org/sites/default/files/slime_idle_0.gif' alt='slime' height='150' width='auto'> </enemy>";
  }
  else{
    document.getElementById("enemys").innerHTML="<enemy class='drop' id='enemy1' style='display: inline-block;'> <img src='https://opengameart.org/sites/default/files/slime_idle_0.gif' alt='slime' height='150' width='auto'> </enemy>";
    document.getElementById("enemys").innerHTML+="<enemy class='drop' id='enemy2' style='display: inline-block;'> <img src='https://opengameart.org/sites/default/files/slime_walk_0.gif' alt='slime' height='150' width='auto'> </enemy>";
  }
 }
</script>
</html>